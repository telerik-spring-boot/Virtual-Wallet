<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/general-fragments :: head('YNPay :: Admin Panel')}"></head>

<body class="svgstroke-a" data-theme="theme-AppleGreen">
<main class="container-fluid px-0">
	<!-- start: page menu link -->
	<div th:replace="~{fragments/general-fragments :: sidebar}"></div>
	<div class="content">
		<!-- start: page header -->
		<div th:replace="~{fragments/general-fragments :: main-header('Admin Panel')}"></div>
		<!-- start: page header area -->
		<div class="px-xl-5 px-lg-4 px-3 py-2 page-header flex-wrap">
			<ol class="breadcrumb mb-0 bg-transparent mb-3 mb-sm-0">
				<li class="breadcrumb-item">
					<a class="text-muted" href="index.html" title="home" th:href="@{/users/dashboard}">Home</a>
				</li>
				<li
						aria-current="page"
						class="breadcrumb-item active"
						title="Balance"
				>
					Admin Panel
				</li>
			</ol>
			<ul class="list-unstyled action mb-0 row g-2">
				<li class="col-sm-6 col-6">
					<div>
						<input class="form-control" name="filter" type="date"/>
					</div>
				</li>
				<li class="dropdown col-sm-6 col-6">
					<a
							aria-expanded="false"
							class="btn border rounded fw-medium w-100"
							data-bs-auto-close="outside"
							data-bs-toggle="dropdown"
							href="#"
					>
						<svg
								class="svg-stroke"
								fill="none"
								stroke="currentColor"
								stroke-linecap="round"
								stroke-linejoin="round"
								viewBox="0 0 24 24"
								width="18"
								xmlns="http://www.w3.org/2000/svg"
						>
							<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
							<path
									d="M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z"
							></path>
						</svg>
						Filter
					</a>
					<div
							class="dropdown-menu dropdown-menu-end p-2 p-xl-3 shadow rounded-4"
							style="width: 300px"
					>
						<h6>Filter Options</h6>
						<div class="row g-3 mt-3">
							<div class="col-12">
								<label class="form-label small text-muted"
								>Sorted by:</label
								>
								<input
										class="form-control"
										placeholder="Search"
										type="search"
								/>
							</div>
							<div class="col-12">
								<label class="form-label small text-muted">Status:</label>
								<select class="form-select">
									<option selected="">Choose...</option>
									<option>...</option>
								</select>
							</div>
							<div class="col-12">
								<label class="form-label small text-muted"
								>Notifications:</label
								>
								<div class="form-check form-switch">
									<input
											class="form-check-input"
											role="switch"
											type="checkbox"
									/>
									<label class="form-check-label">Enabled</label>
								</div>
							</div>
							<div class="col-12 text-end mt-4">
								<button class="btn btn-sm btn-light me-1" type="reset">
									Reset
								</button>
								<button class="btn btn-sm btn-primary" type="submit">
									Apply
								</button>
							</div>
						</div>
					</div>
				</li>
			</ul>
		</div>
		<!-- start: page body area -->
		<div class="px-xl-5 px-lg-4 px-3 py-3 page-body">
			<div class="row">
				<div class="col-xxl-6 col-xl-12 col-lg-12">
					<div class="card mb-3">
						<div class="card-header">
							<h6 class="card-title mb-0">Transactions Overview</h6>
						</div>
						<div class="card-body">
							<div id="apex-basic-column"></div>
						</div>
					</div>
				</div>

				<div class="col-xxl-6 col-xl-12 col-lg-12">
					<div class="card mb-3">
						<div class="card-header">
							<h6 class="card-title mb-0">Users Overview</h6>
						</div>
						<div class="card-body">
							<div id="apex-chart-line-column" style="height: 280px"></div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="px-xl-5 px-lg-4 px-3 py-3 page-body">
			<div class="row">
				<div class="col-12">
					<div class="border p-4 rounded-2 rounded-4 card">
						<div
								class="calendar-tab pb-4"
								style="--dynamic-color: var(--primary-color)"
						>
							<ul
									class="nav nav-pills text-muted text-uppercase"
									role="tablist"
							>
								<li class="nav-item">
									Sun
									<button
											class="nav-link"
											data-bs-target="#c_date_1"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										01
									</button>
								</li>
								<li class="nav-item">
									Mon
									<button
											class="nav-link"
											data-bs-target="#c_date_2"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										02
									</button>
								</li>
								<li class="nav-item">
									Tue
									<button
											class="nav-link"
											data-bs-target="#c_date_3"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										03
									</button>
								</li>
								<li class="nav-item">
									Wed
									<button
											class="nav-link"
											data-bs-target="#c_date_4"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										04
									</button>
								</li>
								<li class="nav-item">
									Thu
									<button
											class="nav-link active"
											data-bs-target="#c_date_5"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										05
									</button>
								</li>
								<li class="nav-item">
									Fri
									<button
											class="nav-link"
											data-bs-target="#c_date_6"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										06
									</button>
								</li>
								<li class="nav-item">
									Sat
									<button
											class="nav-link"
											data-bs-target="#c_date_7"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										07
									</button>
								</li>
								<li class="nav-item">
									Sun
									<button
											class="nav-link"
											data-bs-target="#c_date_8"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										08
									</button>
								</li>
								<li class="nav-item">
									Mon
									<button
											class="nav-link"
											data-bs-target="#c_date_9"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										09
									</button>
								</li>
								<li class="nav-item">
									Tue
									<button
											class="nav-link"
											data-bs-target="#c_date_10"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										10
									</button>
								</li>
								<li class="nav-item">
									Wed
									<button
											class="nav-link"
											data-bs-target="#c_date_11"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										11
									</button>
								</li>
								<li class="nav-item">
									Thu
									<button
											class="nav-link"
											data-bs-target="#c_date_12"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										12
									</button>
								</li>
								<li class="nav-item">
									Fri
									<button
											class="nav-link"
											data-bs-target="#c_date_13"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										13
									</button>
								</li>
								<li class="nav-item">
									Sat
									<button
											class="nav-link"
											data-bs-target="#c_date_14"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										14
									</button>
								</li>
								<li class="nav-item">
									Sun
									<button
											class="nav-link"
											data-bs-target="#c_date_15"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										15
									</button>
								</li>
								<li class="nav-item">
									Sun
									<button
											class="nav-link"
											data-bs-target="#c_date_16"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										16
									</button>
								</li>
								<li class="nav-item">
									Mon
									<button
											class="nav-link"
											data-bs-target="#c_date_17"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										17
									</button>
								</li>
								<li class="nav-item">
									Tue
									<button
											class="nav-link"
											data-bs-target="#c_date_18"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										18
									</button>
								</li>
								<li class="nav-item">
									Wed
									<button
											class="nav-link"
											data-bs-target="#c_date_19"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										19
									</button>
								</li>
								<li class="nav-item">
									Thu
									<button
											class="nav-link"
											data-bs-target="#c_date_20"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										20
									</button>
								</li>
								<li class="nav-item">
									Fri
									<button
											class="nav-link"
											data-bs-target="#c_date_21"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										21
									</button>
								</li>
								<li class="nav-item">
									Sat
									<button
											class="nav-link"
											data-bs-target="#c_date_22"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										22
									</button>
								</li>
								<li class="nav-item">
									Sun
									<button
											class="nav-link"
											data-bs-target="#c_date_23"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										23
									</button>
								</li>
								<li class="nav-item">
									Mon
									<button
											class="nav-link"
											data-bs-target="#c_date_24"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										24
									</button>
								</li>
								<li class="nav-item">
									Tue
									<button
											class="nav-link"
											data-bs-target="#c_date_25"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										25
									</button>
								</li>
								<li class="nav-item">
									Wed
									<button
											class="nav-link"
											data-bs-target="#c_date_26"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										26
									</button>
								</li>
								<li class="nav-item">
									Thu
									<button
											class="nav-link"
											data-bs-target="#c_date_27"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										27
									</button>
								</li>
								<li class="nav-item">
									Fri
									<button
											class="nav-link"
											data-bs-target="#c_date_28"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										28
									</button>
								</li>
								<li class="nav-item">
									Sat
									<button
											class="nav-link"
											data-bs-target="#c_date_29"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										29
									</button>
								</li>
								<li class="nav-item">
									Sun
									<button
											class="nav-link"
											data-bs-target="#c_date_30"
											data-bs-toggle="pill"
											role="tab"
											type="button"
									>
										30
									</button>
								</li>
							</ul>
						</div>
						<div class="d-flex justify-content-center">
							<button id="usersTab" class="btn btn-outline-primary rounded-pill me-2"> Users </button>

							<button id="transfersTab" class="btn btn-outline-info rounded-pill ms-2 info-btn"> Transfers </button>
						</div>
						<table id="usersTable"
						       class="table align-middle table-hover dataTable table-body table-responsive w-100 border rounded-4">

							<thead>
							<tr class="small text-muted text-uppercase">

								<th class="border-end">Full Name</th>
								<th class="border-end">Username</th>
								<th class="border-end">Email</th>
								<th class="border-end">Phone Number</th>
								<th class="border-end">Status</th>
								<th>Options</th>
							</tr>
							</thead>
							<tbody>
							<tr class="row-selectable" th:each="user : ${users}">

								<td class="border-end border-top">
                                                       <span class="d-flex align-items-center">
                                                            <img alt=""
                                                                 class="avatar rounded-circle d-none d-sm-inline-block"
                                                                 src="../static/images/xs/avatar1.jpg"
                                                                 th:src="@{/images/xs/avatar1.jpg}">
                                                            <span class="flex-fill ms-2">
                                                                 <span class="h6 mb-0" th:text="${user.fullName}">Jony Doe</span>
                                                            </span>
                                                       </span>
								</td>
								<td class="border-end border-top" th:text="${user.username}">johny devito</td>
								<td class="border-end border-top" th:text="${user.emailAddress}"> johny@gmail.com</td>
								<td class="border-end border-top" th:text="${user.phoneNumber}">+234234234</td>
								<td class="border-end border-top" th:text="${user.blocked ? 'Blocked' : 'Active'}"></td>
								<td class="border-top">
									<a aria-expanded="false" class="btn btn-outline-secondary w-100"
									   data-bs-toggle="offcanvas" th:href="'#offcanvas_userDetails' + ${user.id}"
									   title="More Action">
										<svg aria-hidden="true" class="w-6 h-6"
										     fill="none" viewBox="0 0 24 24"
										     width="24" xmlns="http://www.w3.org/2000/svg">
											<path d="M6 12h.01m6 0h.01m5.99 0h.01" stroke="currentColor"
											      stroke-linecap="round"
											      stroke-width="3"/>
										</svg>

									</a>
								</td>
								<div aria-labelledby="offcanvas_trdetails" class="offcanvas offcanvas-end" th:id="'offcanvas_userDetails' + ${user.id}" tabindex="-1">
									<div class="offcanvas-header">
										<h5 class="offcanvas-title">User Details</h5>
										<button aria-label="Close" class="btn-close" data-bs-dismiss="offcanvas" type="button"></button>
									</div>
									<div class="offcanvas-body px-0">

										<div class="mb-4 px-3">
											<div class="d-flex align-items-center mb-3">
												<img alt="" class="avatar rounded-circle" src="../static/images/lg/avatar1.jpg"
												     th:src="@{/images/lg/avatar1.jpg}">
												<div class="flex-fill ms-3">
													<div class="h6 mb-1" th:text="${user.fullName}">Jony Doe</div>
													<small class="text-muted" th:text="${#temporals.format(user.getLastOnline(), 'yyyy-MM-dd HH:mm:ss')}">Last seen 12.03.2025</small>
												</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted mb-3" >Username</small>
												<div class="h6 mb-0 pt-3" th:text="${user.username}">jonidevito</div>
											</div>

											<div class="border-bottom py-3">
												<small class="text-muted mb-3">Email Address</small>
												<div class="h6 mb-0 pt-3" th:text="${user.emailAddress}">jonny@gmail.com</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted mb-3">Phone Number</small>
												<div class="h6 mb-0 pt-3" th:text="${user.phoneNumber}">+343423423423</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted mb-1">Verification</small>
												<div class="d-flex">
													<div class="h6 align-self-end" th:if="${user.getVerifiedAt() == null}"> Not Verified </div>
													<div class="h6 mb-0 pt-3" th:if="${user.getVerifiedAt() != null}"> Verified </div>
													<button class="ms-auto btn btn-outline-primary"  th:if="${user.getVerifiedAt() == null}" data-bs-toggle="modal" th:data-bs-target="'#verifyModal' + ${user.id}"> Verify </button>
												</div>
											</div>

											<div class="border-bottom py-3">
												<small class="text-muted mb-1">Status</small>
												<div class="d-flex">
													<div class="h6 align-self-end" th:text="${user.blocked ? 'Blocked' : 'Active'}"> </div>
													<form th:action="@{/admin/users/{userId}/unblock(userId=${user.id})}" method="post">
														<input type="hidden" name="_method" value="PUT"/>
														<button type="submit" class="ms-auto btn btn-outline-primary" th:if="${user.isBlocked()}"> Unblock </button>
													</form>

													<form th:action="@{/admin/users/{userId}/block(userId=${user.id})}" method="post">
														<input type="hidden" name="_method" value="PUT"/>
														<button type="submit" class="ms-auto btn btn-outline-danger" th:if="${!user.isBlocked()}" > Block </button>
													</form>
												</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted mb-1 align-self-start">Role</small>
												<div class="d-flex">
													<div class="h6 align-self-end " th:if="${user.isAdmin()}"> Admin </div>
													<div class="h6 align-self-end" th:if="${!user.isAdmin()}"> User </div>

													<form th:action="@{/admin/users/{userId}/grant(userId=${user.id})}" method="post">
														<input type="hidden" name="_method" value="PUT"/>
														<button type="submit" class="ms-auto btn btn-outline-primary" th:if="${!user.isAdmin()}"> Promote </button>
													</form>

													<form th:action="@{/admin/users/{userId}/revoke(userId=${user.id})}" method="post">
														<input type="hidden" name="_method" value="PUT"/>
														<button type="submit" class="ms-auto btn btn-outline-danger" th:if="${user.isAdmin()}" > Demote </button>
													</form>
												</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted mb-3" >Registration Date</small>
												<div class="d-flex">
													<div class="h6 align-self-end pt-3" th:text="${#temporals.format(user.getCreatedAt(), 'yyyy-MM-dd HH:mm:ss')}"> Feb 05, 2024 At 18:20 </div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- Verify Modal -->
								<div class="modal fade" th:id="'verifyModal' + ${user.id}" tabindex="-1" th:aria-labelledby="'verifyModalLabel' + ${user.id}" aria-hidden="true">
									<div class="modal-dialog modal-lg">
										<div class="modal-content">
											<div class="modal-header">
												<h5 class="modal-title" th:id="'verifyModalLabel' + ${user.id}">Verify Identity</h5>
												<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
											</div>
											<div class="modal-body">
												<form class="text-center d-flex flex-column gap-3" enctype="multipart/form-data" method="post">
													<div class="row">
														<div class="col-6 d-flex flex-column justify-content-between align-items-center">
															<div>
																<img id="preview1" src="../static/images/gallery/idExample.jpg"
																     th:src="@{/images/gallery/idExample.jpg}" class="img-thumbnail mb-3"
																     alt="Preview ID"/>

															</div>


														</div>
														<div class="col-6 d-flex flex-column justify-content-between align-items-center">
															<div>
																<img id="preview2" src="../static/images/gallery/selfieExample.png"
																     th:src="@{/images/gallery/selfieExample.png}" class="img-thumbnail mb-3"
																     alt="Preview Selfie"/>


															</div>
														</div>
													</div>
												</form>
											</div>
											<div class="modal-footer">
												<form th:action="@{/admin/users/{username}/approve-verification(username=${user.username})}" method="post">
													<input type="hidden" name="_method" value="PUT"/>
													<button type="submit"  class="btn btn-primary  ">Approve</button>
												</form>

												<form th:action="@{/admin/users/{username}/reject-verification(username=${user.username})}" method="post">
													<input type="hidden" name="_method" value="PUT"/>
													<button type="submit" class="btn btn-danger" >Reject</button>
												</form>
											</div>
										</div>
									</div>
								</div>
							</tr>
							</tbody>
						</table>

						<table id="transfersTable"
						       class="table align-middle table-hover dataTable table-body table-responsive w-100 border rounded-4">

							<thead>
							<tr class="small text-muted text-uppercase">

								<th class="border-end">From</th>
								<th class="border-end">Amount</th>
								<th class="border-end">Category</th>
								<th class="border-end">Date</th>
								<th class="border-end">Type</th>
								<th>More</th>
							</tr>
							</thead>
							<tbody>
							<tr class="row-selectable" th:each="transaction : ${transactions}">

								<td class="border-end border-top">
                                                       <span class="d-flex align-items-center">
                                                            <img alt=""
                                                                 class="avatar rounded-circle d-none d-sm-inline-block"
                                                                 src="../static/images/xs/avatar1.jpg"
                                                                 th:if="${transaction.transactionType !=  'Deposit'}"
                                                                 th:src="@{/images/xs/avatar1.jpg}">

	                                                       <img alt=""
	                                                            class="avatar rounded-circle d-none d-sm-inline-block"
	                                                            src="../static/images/payment/card.svg"
	                                                            th:if="${transaction.transactionType ==  'Deposit'}"
	                                                            th:src="@{/images/payment/card.svg}">
                                                            <span class="flex-fill ms-2">
                                                                 <span class="h6 mb-0" th:text="${transaction.sender}">Jony Doe</span>
                                                            </span>
                                                       </span>
								</td>
								<td class="border-end border-top" th:text="${transaction.amount} + ' ' + ${transaction.currency}">$500.00</td>
								<td class="border-end border-top" th:text="${transaction.transactionCategory}">Checking</td>
								<td class="border-end border-top" th:text="${transaction.transactionTime}">Feb 05, 2024</td>
								<td class="border-end border-top" th:text="${transaction.transactionType}">Deposit</td>
								<td class="border-top">
									<a aria-expanded="false" class="btn btn-outline-secondary w-100"
									   data-bs-toggle="offcanvas"
									   th:href="'#offcanvas_trdetails_' + ${transaction.transactionId}"
									   title="More Action">
										<svg aria-hidden="true" class="w-6 h-6"
										     fill="none" viewBox="0 0 24 24"
										     width="24" xmlns="http://www.w3.org/2000/svg">
											<path d="M6 12h.01m6 0h.01m5.99 0h.01" stroke="currentColor"
											      stroke-linecap="round"
											      stroke-width="3"/>
										</svg>

									</a>
								</td>
								<!-- start: Transection details rate -->
								<div aria-labelledby="offcanvas_trdetails" class="offcanvas offcanvas-end" th:id="'offcanvas_trdetails_' + ${transaction.transactionId}"  tabindex="-1">
									<div class="offcanvas-header">
										<h5 class="offcanvas-title">Transaction Details</h5>
										<button aria-label="Close" class="btn-close" data-bs-dismiss="offcanvas" type="button"></button>
									</div>
									<div class="offcanvas-body px-0">
										<div class="mb-4 p-3 bg-light">
											<h6 class="text-muted mb-0">Amount</h6>
										</div>
										<div class="mb-4 px-3">
											<h3 th:text="${transaction.getAmount()} + ' ' + ${transaction.currency}">500.00</h3>
										</div>
										<div class="mb-4 p-3 bg-light">
											<h6 class="text-muted mb-0">To</h6>
										</div>
										<div class="mb-4 px-3">
											<div class="d-flex align-items-center mb-3">
												<img alt="" class="avatar rounded-circle" src="../static/images/lg/avatar1.jpg"
												     th:src="@{/images/lg/avatar1.jpg}">
												<div class="flex-fill ms-3">
													<div class="h6 mb-0"    th:text="${transaction.receivers}" > John Jones </div>
													<small class="text-muted" th:text="'IBAN33YNPAY68477732491843244' + ${transaction.receiverWalletId}">**** ****2498 DBS Bank</small>
												</div>
											</div>
										</div>
										<div class="mb-4 p-3 bg-light">
											<h6 class="text-muted mb-0 pt-3">Details</h6>
										</div>
										<div class="mb-4 px-3">
											<div class="border-bottom py-3">
												<small class="text-muted">Payment Type</small>
												<div class="h6 mb-0 pt-3">Internal Transfer</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted">Status</small>
												<div class="h6 mb-0 pt-3">Complete</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted">Transaction Id</small>
												<div class="h6 mb-0 pt-3" th:text="'NVF253688' + ${transaction.transactionId}">NVF25680222</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted">Date &amp; Time</small>
												<div class="h6 mb-0 pt-3" th:text="${transaction.transactionTime}">Feb 05, 2024 At 18:20</div>
											</div>
											<div class="border-bottom py-3">
												<small class="text-muted">Message</small>
												<div class="h6 mb-0 pt-3" th:text="${transaction.getMessage()}">#4433</div>
											</div>
										</div>
									</div>
								</div>
							</tr>
							</tbody>
						</table>

					</div>
				</div>
			</div>
		</div>
	</div>
</main>



<div th:replace="~{fragments/general-fragments :: exchange-rate}"></div>

<th:block th:replace="~{fragments/general-fragments.html :: scripts}"></th:block>

<script src="../static/bundles/dataTables.bundle.js" th:src="@{/bundles/dataTables.bundle.js}"></script>

<link href="../static/vendor/dataTables.css" rel="stylesheet" th:href="@{/vendor/dataTables.css}"/>

<script th:inline="javascript">
    document.addEventListener("DOMContentLoaded", function () {
        // Scroll handling for .calendar-tab .nav
        const scrollContainer = document.querySelector(".calendar-tab .nav");
        if (scrollContainer) {
            scrollContainer.addEventListener("wheel", (evt) => {
                evt.preventDefault();
                scrollContainer.scrollLeft += evt.deltaY;
            });
        }
    });

    $(document).ready(function () {
        // Initialize DataTable
        $("#usersTable").dataTable({
            responsive: true,


            // columnDefs: [
            //     {
            //         targets: 3, // Corrected 'target' to 'targets'
            //         render: DataTable.render.date(),
            //     },
            //     {
            //         targets: 4, // Corrected 'target' to 'targets'
            //         render: DataTable.render.number(null, null, 0, "$"),
            //     },
            // ],
        });



        // Stacked Area
        var options = {
            chart: {
                height: 100,
                type: "area",
                stacked: true,
                toolbar: {
                    show: false,
                },
                events: {
                    selection: function (chart, e) {
                        console.log(new Date(e.xaxis.min));
                    },
                },
            },
            colors: ["#e4bd51"],
            dataLabels: {
                enabled: false,
            },

            series: [
                {
                    name: "Central",
                    data: generateDayWiseTimeSeries(
                        new Date("14 Aug 2024 GMT").getTime(),
                        10,
                        {
                            min: 20,
                            max: 48,
                        }
                    ),
                },
            ],

            fill: {
                type: "gradient",
                gradient: {
                    opacityFrom: 0.6,
                    opacityTo: 0.8,
                },
            },

            legend: {
                position: "top",
                horizontalAlign: "right",
                show: true,
            },
            xaxis: {
                type: "datetime",
            },
            grid: {
                yaxis: {
                    lines: {
                        show: false,
                    },
                },
                padding: {
                    top: 0,
                    right: 0,
                    bottom: 0,
                    left: 0,
                },
            },
            stroke: {
                show: true,
                curve: "smooth",
                width: 2,
            },
        };

        var chart = new ApexCharts(
            document.querySelector("#movement-apex"),
            options
        );
        chart.render();

        function generateDayWiseTimeSeries(baseval, count, yrange) {
            var i = 0;
            var series = [];
            while (i < count) {
                var x = baseval;
                var y =
                    Math.floor(Math.random() * (yrange.max - yrange.min + 1)) +
                    yrange.min;

                series.push([x, y]);
                baseval += 86400000;
                i++;
            }
            return series;
        }
    });

    $(document).ready(function () {

        var users = /*[[${users}]]*/ [];

        var monthLabels = [];
        var createdCounts = Array(12).fill(0);
        var verifiedCounts = Array(12).fill(0);

        var now = new Date();
        var currentYear = now.getFullYear();
        var currentMonth = now.getMonth();


        for (let i = 0; i < 12; i++) {
            let month = new Date(currentYear, currentMonth - i, 1);
            monthLabels.unshift(month);
        }



        users.forEach(user => {
            let createdAt = new Date(user.createdAt);
            let verifiedAt = user.verifiedAt ? new Date(user.verifiedAt) : null;

            for (let i = 0; i < 12; i++) {
                let month = new Date(currentYear, currentMonth - i, 1);

                if (
                    createdAt.getFullYear() === month.getFullYear() &&
                    createdAt.getMonth() === month.getMonth()
                ) {
                    createdCounts[11-i]++;
                }

                if (
                    verifiedAt &&
                    verifiedAt.getFullYear() === month.getFullYear() &&
                    verifiedAt.getMonth() === month.getMonth()
                ) {
                    verifiedCounts[11-i]++;
                }
            }
        });


        let formattedLabels = monthLabels.map(dateStr => {
            let date = new Date(dateStr);
            return date.toLocaleString("en-US", { month: "short" }).slice(0, 3);
        });


        // Create the chart
        var options = {
            chart: {
                height: 500,
                type: "line",
                toolbar: {
                    show: false,
                },
            },
            colors: ["var(--theme-color2)", "var(--theme-color4)"],
            series: [
                {
                    name: "Created Users",
                    type: "column",
                    data: createdCounts,
                },
                {
                    name: "Verified Users",
                    type: "line",
                    data: verifiedCounts,
                },
            ],
            stroke: {
                width: [0, 4],
            },
            labels: formattedLabels,
            xaxis: {
                type: "category",
            },
            yaxis: [
                {
                    title: {
                        text: "Registered Users",
                    },
                },
                {
                    opposite: true,
                    title: {
                        text: "Verified Users",
                    },
                },
            ],
            tooltip: {
                theme: "dark",
            },
        };

        var chart = new ApexCharts(
            document.querySelector("#apex-chart-line-column"),
            options
        );
        chart.render();
    });

    $(document).ready(function () {

        var transactions = /*[[${transactions}]]*/[];

        const conversionRates = {
            EUR: 1.09,
            GBP: 1.30,
            USD: 1,
        };


        let depositCounts = Array(12).fill(0);
        let transferCounts = Array(12).fill(0);
        let monthLabels = Array(12).fill(0);


        const currentDate = new Date();
        const currentMonth = currentDate.getMonth();
        const currentYear = currentDate.getFullYear();




        let formattedLabels = monthLabels.map(dateStr => {
            let date = new Date(dateStr);
            return date.toLocaleString("en-US", { month: "short" }).slice(0, 3);
        });


        transactions.forEach((transaction) => {

            console.log(transaction.transactionTime);
            const transactionDate = new Date(transaction.transactionTime);
            const transactionMonth = transactionDate.getMonth();
            const transactionYear = transactionDate.getFullYear();


            const conversionRate = conversionRates[transaction.currency];
            const amountInUSD = transaction.amount * conversionRate;

            const monthDiff = currentMonth - transactionMonth + (currentYear - transactionYear) * 12;

            if (monthDiff >= 0 && monthDiff < 12) {

                if (transaction.transactionType === "Deposit") {
                    depositCounts[11 - monthDiff] += amountInUSD;
                } else if (transaction.transactionType === "Internal Transfer") {
                    transferCounts[11 - monthDiff] += amountInUSD;
                }
            }
        });

        var options = {
            chart: {
                height: 500,
                type: "bar",
            },
            colors: [
                "var(--theme-color2)",
                "var(--theme-color3)",
	            "var(--theme-color4)",
            ],
            plotOptions: {
                bar: {
                    horizontal: false,
                    columnWidth: "55%",
                    endingShape: "rounded",
                },
            },
            dataLabels: {
                enabled: false,
            },
            stroke: {
                show: true,
                width: 2,
                colors: ["transparent"],
            },
            series: [
                {
                    name: "Deposits",
                    data: depositCounts,
                },
                {
                    name: "Internal Transfers",
                    data: transferCounts,
                },
                {
                    name: "Trading Volume",
                    data: [234, 100, 34, 444, 232, 444, 434, 1, 0, 344, 44, 33],
                },
            ],
            xaxis: {
                categories: formattedLabels,
            },
            yaxis: {
	            labels:{
                    formatter: function(val) {
                        return "$ " + val.toFixed(2); // Limits the decimal places to 2 for Y-axis labels
                    },
	            }
            },
            fill: {
                opacity: 1,
            },
            tooltip: {
                theme: "dark",
                y: {
                    formatter: function (val) {
                        return "$ " + val.toFixed(2);
                    },
                },
            },
        };


        var chart = new ApexCharts(
            document.querySelector("#apex-basic-column"),
            options
        );
        chart.render();
    });

    $(document).ready(function () {
        let usersTable = $('#usersTable').DataTable();
        let transfersTable = $('#transfersTable').DataTable();

        // Initially hide Transfers table
        $('#transfersTable_wrapper').hide();

        // When Users button is clicked
        $('#usersTab').on('click', function () {
            // Activate Users button, deactivate Transfers button
            $(this).addClass('active');
            $('#transfersTab').removeClass('active');

            // Show Users table and hide Transfers table
            $('#usersTable_wrapper').show();
            $('#transfersTable_wrapper').hide();

            // Adjust DataTable layout for Users
            usersTable.columns.adjust().responsive.recalc();
        });

        // When Transfers button is clicked
        $('#transfersTab').on('click', function () {
            // Activate Transfers button, deactivate Users button
            $(this).addClass('active');
            $('#usersTab').removeClass('active');

            // Show Transfers table and hide Users table
            $('#transfersTable_wrapper').show();
            $('#usersTable_wrapper').hide();

            // Adjust DataTable layout for Transfers
            transfersTable.columns.adjust().responsive.recalc();
        });
    });

</script>


</body>
</html>
